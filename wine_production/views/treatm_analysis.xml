<?xml version="1.0" encoding="utf-8"?>

<odoo>
  <data>

      <!-- Creating the treatments menu -->

      <act_window id="action_treatments"
      name="Treatments"
      res_model="wine.treatment"
      view_mode="tree,form"/>

      <menuitem id='menu_treatments'
      string='Treatments'
      parent="menu_wine_analysis_management"
      action="action_treatments"/>


      <record id="view_treatments_list" model="ir.ui.view">
       <field name="name">treatments_list_view</field>
       <field name="model">wine.treatment</field>
       <field name="arch" type="xml">
           <tree string="treatments">
             <field name="name"/>
             <field name="type_id"/>
             <field name="vineyard_id"/>
             <field name="vineyard_phase"/>
             <field name="date_execution"/>
             <field name="executor"/>
           </tree>
       </field>
      </record>

      <record id="view_treatment_form" model="ir.ui.view">
        <field name="name">treatments_form_view</field>
        <field name="model">wine.treatment</field>
        <field name="arch" type="xml">
          <form string="treatments">
            <sheet>
              <group name="group_top" string="Treatments details">
                <group name="group_left">
                  <field name="name"/>
                  <field name="type_id"/>
                  <field name="date_execution"/>
                  <field name="executor"/>
                  <field name="vineyard_id"/>
                  <field name="vineyard_phase"/>
                  <field name="reason"/>
                  <field name="treat_prod_ids"/>
                </group>
             </group>
             <group>
              <field name="comments" string="Comments"/>
            </group>
             </sheet>

          </form>
         </field>
     </record>

     <!-- Creating the "treat_product" list view -->
     <record id="view_treat_prod_list" model="ir.ui.view">
      <field name="name">treat_prod_list_view</field>
      <field name="model">wine.treat_prod</field>
      <field name="arch" type="xml">
          <tree editable='True'>
            <field name="product"/>
            <field name="quantity"/>
          </tree>
      </field>
     </record>

     <!-- defininf the WORT LOT search view -->
     <record id="view_treatment_search_view" model="ir.ui.view">
        <field name="name">view_treatment_search_view</field>
        <field name="model">wine.treatment</field>
        <field name="arch" type="xml">
          <search>
            <group expand="0" string="Group By">
              <filter name="group_date" string="Year" context="{'group_by': ['date_execution:year']}"/>
              <filter name="group_date" string="Month" context="{'group_by': ['date_execution:month']}"/>
            </group>
          </search>
        </field>
     </record>

     <!-- Creating the "vineyard analysis" menu -->

     <act_window id="action_vineyard_analysis"
     name="vineyard analysis"
     res_model="wine.vineyard_analysis"
     view_mode="tree,form"/>

     <menuitem id='menu_vineyard_analysis'
     string='vineyard_analysis'
     parent="menu_wine_analysis_management"
     action="action_vineyard_analysis"/>


     <record id="view_vineyard_analysis_list" model="ir.ui.view">
      <field name="name">vineyard_analysis_list_view</field>
      <field name="model">wine.vineyard_analysis</field>
      <field name="arch" type="xml">
          <tree string="vineyard_analysis">
            <field name="name"/>
            <field name="vineyard_id"/>
            <field name="date_analysis"/>

            <field name="sand" string='S' help="Sand"/>
            <field name="clay" string='C'/>
            <field name="lime" string='L'/>
            <field name="ph" string='pH'/>
            <field name="limestone_active" string='lA'/>
            <field name="limestone_total" string='lT'/>
            <field name="organ_carbon" string='oC'/>
            <field name="organ_substance"  string='oS'/>
            <field name="nitrogen"  string='nT'/>
            <field name="c_n_rel" string='c/n'/>
            <field name="cationic_exch"  string='c/Ex'/>
            <field name="calcium_mg_kg"  string='Cg/K'/>
            <field name="calcium_meq_hg" string='Cq/K'/>
            <field name="magnesium_mg_kg" string='Mg/'/>
            <field name="magnesium_meq_hg"  string='Ms'/>
            <field name="potassium_mg_kg"  string='Pg/K'/>
            <field name="potassium_meq_hg" string='Pq/k'/>
            <field name="ca_mg"  string='Ca/m'/>
            <field name="ca_kg" string='Ca/k'/>
            <field name="mg_kg"  string='mg/kg'/>
            <field name="phosphorus"  string='ph'/>
            <field name="phosph_anhydride"  string='phA'/>

          </tree>
      </field>
     </record>

     <record id="view_vineyard_analysis_form" model="ir.ui.view">
       <field name="name">vineyard_analysis_form_view</field>
       <field name="model">wine.vineyard_analysis</field>
       <field name="arch" type="xml">
         <form string="vineyard_analysis">
           <sheet>
             <group name="group_top" string="vineyard analysis">
               <group name="group_left" string="Dati generali">
                 <field name="name"/>
                 <field name="vineyard_id"/>
                 <field name="date_analysis"/>
            </group>
              <group name="group_right" string="Terreno">
                   <field name="sand"/>
                   <field name="clay"/>
                   <field name="lime"/>
              </group>
              <group name="group_left" string="Dati chimici">
                   <field name="ph"/>
                   <field name="limestone_active"/>
                   <field name="limestone_total"/>
                   <field name="organ_carbon"/>
                   <field name="organ_substance"/>
                   <field name="nitrogen"/>
                   <field name="c_n_rel"/>
                   <field name="cationic_exch"/>
              </group>
              <group name="group_right" string="Altri dati">
                   <field name="calcium_mg_kg"/>
                   <field name="calcium_meq_hg"/>
                   <field name="magnesium_mg_kg"/>
                   <field name="magnesium_meq_hg"/>
                   <field name="potassium_mg_kg"/>
                   <field name="potassium_meq_hg"/>
                   <field name="ca_mg"/>
                   <field name="ca_kg"/>
                   <field name="mg_kg"/>
                   <field name="phosphorus"/>
                   <field name="phosph_anhydride"/>
              </group>
            </group>
             <field name="comments" string="Comments"/>

            </sheet>

         </form>
        </field>
    </record>

    <!-- defininf the WORT LOT search view -->
    <record id="view_vineyard_analysis_search_view" model="ir.ui.view">
       <field name="name">view_vineyard_analysist_search_view</field>
       <field name="model">wine.vineyard_analysis</field>
       <field name="arch" type="xml">
         <search>
           <group expand="0" string="Group By">
             <filter name="group_date" string="Year" context="{'group_by': 'vineyard'}"/>
             <filter name="group_date" string="Year" context="{'group_by': ['date_analysis:year']}"/>
             <filter name="group_date" string="Month" context="{'group_by': ['date_analysis:month']}"/>
           </group>
         </search>
       </field>
    </record>

    <!-- Creating the "Wine analysis" menu -->

    <act_window id="action_wine_analysis"
    name="Wine analysis"
    res_model="wine.wine_analysis"
    view_mode="tree,form"/>

    <menuitem id='menu_wine_analysis'
    string='Wine Analysis'
    parent="menu_wine_analysis_management"
    action="action_wine_analysis"/>


    <record id="view_wine_analysis_list" model="ir.ui.view">
     <field name="name">wine_analysis_list_view</field>
     <field name="model">wine.wine_analysis</field>
     <field name="arch" type="xml">
         <tree string="wine_analysis">
           <field name="name"/>
           <field name="prod_sample"/>
           <field name="sampling_date"/>
           <field name="sampling_partner"/>

           <field name="relative_density" string='Dens.'/>
           <field name="alcohol_devel" string='Alc.'/>
           <field name="sugars" string='Zuc.'/>
           <field name="alcohol_degree" string='Alc.Tot.'/>
           <field name="tot_acidity" string='Ac.'/>
           <field name="volat_acidity" string='Ac.Vol.'/>
           <field name="tot_dry" string='Sec.'/>
           <field name="extr_no_sugar"  string='Non.Rid.' help='Estratto non riduttore'/>
           <field name="tot_ashes"  string='Cen.'/>
           <field name="chlorides" string='Clor.'/>
           <field name="sulphates"  string='Solf.'/>
           <field name="tot_sulph_diox"  string='Anid.'/>
           <field name="overpressure" string='Sov.'/>

         </tree>
     </field>
    </record>

    <record id="view_wine_analysis_form" model="ir.ui.view">
      <field name="name">wine_analysis_form_view</field>
      <field name="model">wine.wine_analysis</field>
      <field name="arch" type="xml">
        <form string="wine_analysis">
          <sheet>

              <group name="group_top" string="Grape analysis details">
                <group name="group_left">
                  <field name="name"/>
                  <field name="sampling_date"/>
                  <field name="sampling_partner"/>
                  <field name="prod_sample"/>

                </group>
              </group>

              <group col='6'>
                <group name="group_1" string="Uva" colspan='2'>
                  <field name="grape_lot" domain="[('stage_id', '!=', 'closed')]"/>
                </group>

                <group name="group_2" string="Mosto" colspan='2'>
                  <field name="wort_lot" domain="[('stage_id', '!=', 'closed')]"/>
                </group>

                <group name="group_3" string="Bottiglia" colspan='2'>
                    <field name="sample_bottle" />
                </group>
              </group>
              <group string="Dati analisi bottiglia"
                  attrs="{'invisible':[('sample_bottle', '!=', True)]}">
                <field name="bottle_lot" />
            </group>
               <group name="group_bottom" string="Parametri Generali">
                 <group col='6'>
                   <field name="relative_density" colspan='2'/>
                   <field name="relative_density_meth" colspan='2' />
                   <field name="relative_density_uncert" colspan='2'/>

                   <field name="alcohol_devel" colspan='2'/>
                   <field name="alcohol_devel_meth"  colspan='2' />
                   <field name="alcohol_devel_uncert" />

                   <field name="sugars" colspan='2'/>
                   <field name="sugars_meth"  colspan='2' />
                   <field name="sugars_uncert" colspan='2' />

                   <field name="alcohol_degree" colspan='2'/>
                   <field name="alcohol_degree_meth"  colspan='2' />
                   <field name="alcohol_degree_uncert" colspan='2' />

                   <field name="tot_acidity" colspan='2'/>
                   <field name="tot_acidity_meth"  colspan='2' />
                   <field name="tot_acidity_uncert" colspan='2' />

                   <field name="volat_acidity" colspan='2'/>
                   <field name="volat_acidity_meth"  colspan='2' />
                   <field name="volat_acidity_uncert" colspan='2' />

                   <field name="extr_no_sugar" colspan='2'/>
                   <field name="extr_no_sugar_meth"  colspan='2' />
                   <field name="extr_no_sugar_uncert" colspan='2' />

                  <field name="tot_dry" colspan='2'/>
                  <field name="tot_dry_meth"  colspan='2' />
                  <field name="tot_dry_uncert" colspan='2' />

                   <field name="tot_ashes" colspan='2'/>
                   <field name="tot_ashes_meth"  colspan='2' nolabel='True' />
                   <field name="tot_ashes_uncert" colspan='2' />

                   <field name="chlorides" colspan='2'/>
                   <field name="chlorides_meth"  colspan='2' />
                   <field name="chlorides_uncert"  colspan='2'/>

                   <field name="sulphates" colspan='2'/>
                   <field name="sulphates_meth"  colspan='2' />
                   <field name="sulphates_uncert"  colspan='2'/>

                   <field name="tot_sulph_diox" colspan='2'/>
                   <field name="tot_sulph_diox_meth"  colspan='2' />
                   <field name="tot_sulph_diox_uncert" colspan='2' />

                   <field name="overpressure" colspan='2'/>
                   <field name="overpressure_meth"  colspan='2' />
                   <field name="overpressure_uncert"  colspan='2'/>

                 </group>
               </group>

              <group string="Comments">
                  <field name="comments"/>
              </group>
           </sheet>

        </form>
       </field>
    </record>

    <!-- defininf the wine analysis search view -->
    <record id="view_wine_analysis_search_view" model="ir.ui.view">
       <field name="name">view_wine_analysis_search_view</field>
       <field name="model">wine.wine_analysis</field>
       <field name="arch" type="xml">
         <search>
           <group expand="0" string="Group By">
             <filter name="group_date" string="Year" context="{'group_by': 'prod_sample'}"/>
             <filter name="group_date" string="Year" context="{'group_by': ['sampling_date:year']}"/>
             <filter name="group_date" string="Month" context="{'group_by': ['sampling_date:month']}"/>
           </group>
         </search>
       </field>
    </record>

    <!-- Creating the "Additions" menu -->

    <act_window id="action_additions"
    name="Additions"
    res_model="wine.additions"
    view_mode="tree,form,graph"/>

    <menuitem id='menu_additions'
    string='Additions'
    parent="menu_wine_analysis_management"
    action="action_additions"/>


    <record id="view_additions_list" model="ir.ui.view">
     <field name="name">additions_list_view</field>
     <field name="model">wine.additions</field>
     <field name="arch" type="xml">
         <tree string="additions">
           <field name="name"/>
           <field name="date_exec"/>
           <field name="additive"/>
           <field name="quantity"/>
           <field name="grape_lot"/>
           <field name="wort_lot"/>

         </tree>
     </field>
    </record>

    <record id="view_additions_form" model="ir.ui.view">
      <field name="name">additions_form_view</field>
      <field name="model">wine.additions</field>
      <field name="arch" type="xml">
        <form string="additions">
          <sheet>

              <group name="group_top" string="Aggiunta">
                <group name="group_left">
                  <field name="name"/>
                  <field name="date_exec"/>
                  <field name="additive"/>
                  <field name="quantity"/>
                  <field name="grape_lot" domain="[('stage_id', '!=', 'closed')]"/>
                  <field name="wort_lot" domain="[('stage_id', '!=', 'closed')]"/>
                </group>
              </group>

              <group string="Comments">
                  <field name="comments"/>
              </group>
           </sheet>
        </form>
       </field>
    </record>

    <!-- defininf the additions search view -->
    <record id="view_additions_search_view" model="ir.ui.view">
       <field name="name">view_additionss_search_view</field>
       <field name="model">wine.additions</field>
       <field name="arch" type="xml">
         <search>
           <group expand="0" string="Group By">
             <filter name="group_date" string="Wort" context="{'group_by': 'wort_lot'}"/>
             <filter name="group_date" string="Year" context="{'group_by': ['date_exec:year']}"/>
             <filter name="group_date" string="Month" context="{'group_by': ['date_exec:month']}"/>
           </group>
         </search>
       </field>
    </record>

    <!-- adding the graph view to the additions view -->

    <record id="view_additions_graph" model="ir.ui.view">
         <field name="name"> additions_graph_view</field>
         <field name="model">wine.additions</field>
         <field name="arch" type="xml">
           <graph string="Wort Analysis" type="pivot" stacked="True">
             <field name="additive" type="row"/>
             <field name="wort_lot" type="row"/>
             <field name="date_exec" type="col"/>
             <field name="quantity" type="measure"/>
           </graph>
         </field>
     </record>


  </data>
</odoo>
