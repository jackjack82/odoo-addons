<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record model="ir.ui.view" id="custom_bi_pos_discount_form_view">
			<field name="name">pos.config.form.extended.view</field>
			<field name="model">pos.config</field>
			<field name="inherit_id" ref="point_of_sale.pos_config_view_form"/>
			<field name="arch" type="xml">
				<xpath expr="//div[5]" position="after">
					<h2 name="order">Maximum Order Amount Configuration</h2>
					<div class="row mt16 o_settings_container">
						<div id="max_order_amt" class="col-xs-12 col-md-6 o_setting_box">
							<div class="o_setting_right_pane">
								<label for="max_order_amt"/>
								<field name="max_order_amt"/>
							</div>
						</div>
					</div>
				</xpath>
			</field>
		</record>

		<!-- POS Loyalty Configuration -->
		<record id="view_pos_loyalty_setting_tree_view" model="ir.ui.view">
			<field name="name">pos.loyalty.config.tree.view</field>
			<field name="model">pos.loyalty.setting</field>
			<field name="arch" type="xml">
				<tree string="POS Loyalty Configuration">
						<field name="name"/>	
						<field name="product_id"/>			
						<field name="issue_date"/>	
						<field name="expiry_date"/>
						<field name="active"/>
				</tree>
			</field>
		</record>

		<record id="pos_loyalty_setting_form_view" model="ir.ui.view">
			<field name="name">pos.loyalty.config.form.view</field>
			<field name="model">pos.loyalty.setting</field>
			<field name="arch" type="xml">
				<form string="POS Loyalty Configuration">
					<sheet>
						<group>
							<group>
								<field name="name" required="1"/>
								<field name="product_id"/>
								<field name="active"/>
							</group>
							<group>
								<field name="issue_date"/>
								<field name="expiry_date"/>
								<field name="issue_onlydate" invisible="1"/>
								<field name="expiry_onlydate" invisible="1"/>
							</group>
						</group>
						<notebook>
							<page string="Loyalty Calculation">
								<group>
									<field name="loyalty_basis_on"/>
									<field name="loyaly_points" invisible="1"/>
									<field name="company_id" invisible="1"/>
									<field name="currency_id" invisible="1"/>
									<br/>
								</group>
								<div>
									<div>
										<b > Every Purchase Amount of 
											<field name="currency_amt" class="oe_inline" widget='monetary' options="{'currency_field': 'currency_id'}" /> :

										</b>
										<b  style="color:blue;margin:0px 10px;">
											<field name="loyaly_points"  class="oe_inline"/>
										</b>
										<b>
											<span>Loyalty Points </span>
										</b>
									</div>
								</div>
							</page>
							<page string="Redemption Rule">
								<div style="padding: 20px;">
									<b>
									<span>1 Voucher : </span>
									</b>
									<b  style="color:blue;margin:0px 10px;">
										<field name="redeem_points"  class="oe_inline"/>
									</b>
									<b>
									<span>Loyalty Points </span>
									</b>
								</div>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
		

		<record model="ir.actions.act_window" id="action_pos_loyalty_setting">
			<field name="name">Loyalty Configuration</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">pos.loyalty.setting</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
		</record>



		<!-- POS Loyalty History -->
		<record id="view_pos_loyalty_history_tree_view" model="ir.ui.view">
			<field name="name">pos.loyalty.history.tree.view</field>
			<field name="model">pos.loyalty.history</field>
			<field name="arch" type="xml">
			   <tree string="POS Loyalty History" create="0" edit="0">
						<field name="order_id"/>	
						<field name="partner_id"/>			
						<field name="transaction_type"/>	
						<field name="date"/>
						<field name="points"/>
				</tree>
			</field>
		</record>



		<record id="pos_loyalty_history_form_view" model="ir.ui.view">
			<field name="name">pos.loyalty.history.form.view</field>
			<field name="model">pos.loyalty.history</field>
			<field name="arch" type="xml">
				<form string="POS Loyalty History" create="0" edit="0" >
						<sheet>
							<group>
								<group>
									<field name="date"/>
									<field name="order_id"/>
									<field name="partner_id"/>
									<field name="user_id"/>
									<field name="user_barcode"/>
									<field name="session_id"/>
								</group>
								<group>
									<field name="transaction_type"/>
									<field name="total_points"/>
									<field name="points"/>
									<field name="product_id" attrs="{'invisible': [('transaction_type', '=', 'credit')]}"/>
									<field name="voucher_amount" attrs="{'invisible': [('product_id', '=', False)]}"/>
								</group>
							</group>
						</sheet>
				</form>
			</field>
		</record>

		<record id="view_loyalty_history_search" model="ir.ui.view">
			<field name="name">pos.loyalty.history.search</field>
			<field name="model">pos.loyalty.history</field>
			<field name="arch" type="xml">
				<search string="POS loyalty history Search">
					<filter string="Partners" name="group_by_partner_id" context="{'group_by':'partner_id'}"/>
				</search>
			</field>
		</record>
		

		<record model="ir.actions.act_window" id="action_pos_loyalty_history">
			<field name="name">Loyalty History</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">pos.loyalty.history</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
		</record>
		
		
		<menuitem name="Loyalty Management" id="menu_pos_loyalty_id" parent="point_of_sale.menu_point_root" sequence="10"/>

		<menuitem parent="pos_loyalty_odoo.menu_pos_loyalty_id" action="action_pos_loyalty_setting" id="menu_pos_loyalty_setting"
			sequence="5"/>
			
		<menuitem parent="pos_loyalty_odoo.menu_pos_loyalty_id" action="action_pos_loyalty_history" id="menu_pos_loyalty_history"
			sequence="6"/>

		<!-- res.partner Configuration -->
		<record id="view_res_partner_loyalty_form" model="ir.ui.view">
			<field name="name">res.partner.pos.loyalty.form.inherit</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="point_of_sale.view_partner_property_form"/>
			<field name="arch" type="xml">
				<field name="vat" position="after">
					<field name="dob"/>
					<field name="gender"/> 
					<field string="Loyalty Points" name="loyalty_points"/>
				</field>
				<page name="accounting" position='after'>
					<page string="Loyalty History">
						<field name="history_ids"/> 
					</page>
				</page>
			</field>
		</record>
	</data>
</odoo>
